{% extends 'base.html.twig' %} 
{% block javascripts %} 
   <script language = "javascript" 
      src = "https://code.jquery.com/jquery-2.2.4.min.js"></script> 
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
   
   <script language = "javascript">  
      $(document).ready(function(){
       $(document).ready(function () {
            $.ajax({  
               url:        '/home',  
               type:       'POST',   
               dataType:   'json',
               async:      true,  
               success: function(data, status) {  
                  var e = $('<tr><th style="text-align:center">Oda No</th><th>İsim</th><th>Soyisim</th><th>Kayıt Tarihi</th><th>Ek bilgiler</th></tr>');  
                  $('#client').html('');  
                  $('#client').append(e);  
                  if(data.length > 0){
                    for(i = 0; i < data.length; i++) {  
                        client = data[i];  
                        var e = $('<tr><td id = "t_oda_no"></td><td id = "t_isim"></td><td id = "t_soyisim"></td><td id = "t_kayit_tarihi"></td><td id = "t_ek_bilgiler"></td></tr>');
                        
                        $('#t_oda_no', e).html(client['oda_no']);  
                        $('#t_isim', e).html(client['isim']);  
                        $('#t_soyisim', e).html(client['soyisim']);
                        $('#t_kayit_tarihi', e).html(client['kayit_tarihi']);  
                        $('#t_ek_bilgiler', e).html(client['ek_bilgiler']);  
                        $('#client').append(e);  
                    }  
                  } else {
                    var e = $('<tr><td colspan = 5 style="text-align:center; background-color:#ccc">Müşteri kaydı bulunamamıştır</td></tr>');
                        $('#client').append(e); 
                  }
                    var currentURL = window.location.href;
                    var part = currentURL.split('/').pop();
                    if(part != 'home'){
                        window.location.href = '/home'
                    } 
                },  
               error : function(xhr, textStatus, errorThrown) {  
                  alert('Ajax request failed.');  
               }  
            });  
         });
         $("#addclient").on("click", function(event){  
            window.location.href = '/kayit';
         }); 

        var filterButton = document.getElementById("filter");
        var filterContainer = document.getElementById("filterContainer");

        filterButton.addEventListener("click", function() {
            if (filterContainer.style.display === "none" || filterContainer.style.display === "") {
                filterContainer.style.display = "block";
            } else {
                filterContainer.style.display = "none";
            }
        });

        $(document).ready(function() {
            $('#filterForm').submit(function(e) {
                e.preventDefault();

                var filterData = $(this).serialize();

                $.ajax({
                type: 'POST',
                url: '/filter',
                data: filterData, 
               success: function(data, status) {  
                  var e = $('<tr><th style="text-align:center">Oda No</th><th>İsim</th><th>Soyisim</th><th>Kayıt Tarihi</th><th>Ek bilgiler</th></tr>');  
                  $('#client').html('');  
                  $('#client').append(e);  
                  if(data.length > 0){
                    for(i = 0; i < data.length; i++) {  
                        client = data[i];  
                        var e = $('<tr><td id = "t_oda_no"></td><td id = "t_isim"></td><td id = "t_soyisim"></td><td id = "t_kayit_tarihi"></td><td id = "t_ek_bilgiler"></td></tr>');
                        
                        $('#t_oda_no', e).html(client['oda_no']);  
                        $('#t_isim', e).html(client['isim']);  
                        $('#t_soyisim', e).html(client['soyisim']);
                        $('#t_kayit_tarihi', e).html(client['kayit_tarihi']);  
                        $('#t_ek_bilgiler', e).html(client['ek_bilgiler']);  
                        $('#client').append(e);  
                    }  
                  } else {
                    var e = $('<tr><td colspan = 5 style="text-align:center; background-color:#ccc">Müşteri kaydı bulunamamıştır</td></tr>');
                        $('#client').append(e); 
                  }
                    var currentURL = window.location.href;
                    var part = currentURL.split('/').pop();
                    if(part != 'home'){
                        window.location.href = '/home'
                    } 
                },  
               error : function(xhr, textStatus, errorThrown) {  
                  alert('Ajax request failed.');  
               }  
                });
            });
        });



        
    });  
   </script> 
{% endblock %}  

{% block stylesheets %} 
   <style> 
   .table {
        width: 100%;
        border-collapse: collapse; } 
    .table th, td {
        padding:5px;
        border-bottom: 1px solid #ddd; 
        width: 20%;
        height: auto;
        text-align: left; 
        align: left; 
    }
    .filter-container .table th,td {
        padding:1px;
        border-bottom: 0px; 
    }
    .container {
        max-width: 60%;
        margin: 0 auto;
    }
    .page-header {
        text-align: center;
        margin-top: 20px;
    }
    .top-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 20px;
    }
    .add-client-button {
        width: 20%;
        padding: 2px;
        margin: 20px;
        text-align: center;
        background-color: #a1a1f4;
    }
    .add-client-button:hover{
        background-color: #6b6be4;
    }
    .filter-button {
        width: 20%;
        padding: 2px;
        margin: 20px;
        text-align: center;
        background-color: #afffaf;
    }
    .filter-button:hover {
        background-color: #7ff97f;
    }
    #client td#oda_no {
        text-align: center;
    }

    #filterFormButton{
        text-align:center; 
        background-color:#6fcfff;
    }

    #filterFormButton:hover{
        background-color:#437aff;
    }

    #t_oda_no{
        text-align:center; 
    }
    
    .filter-container{
        display:none; 
        width:50%;
    }
   </style> 
{% endblock %} 

{% block body %} 
    <div class="container">
        <h1 class="page-header">OTEL KAYIT SİSTEMİ</h1>
        <div class="top-container">
            <button class="btn btn-primary filter-button" id = "filter">Filtrele</button>
            <button class="btn btn-primary add-client-button" id = "addclient">Yeni Müşteri Ekle</button>
        </div>
        <div class="filter-container" id="filterContainer">
            <form id="filterForm">
                <table>
                    <tr>
                        <td><label for="isim">İsim:</label></td>
                        <td><input type="text" class="form-control" id="isim" name="isim"></td>
                    </tr>
                    <tr>
                        <td><label for="soyisim">Soyisim:</label></td>
                        <td><input type="text" class="form-control" id="soyisim" name="soyisim"></td>
                    </tr>
                    <tr>
                        <td><label for="oda_no">Oda No:</label></td>
                        <td><input type="text" class="form-control" id="oda_no" name="oda_no"></td>
                    </tr>
                    {# <tr>
                        <td><label for="kayit_tarihi">Kayıt Tarihi:</label></td>
                        <td><input type="text" class="form-control" id="kayit_tarihi" name="kayit_tarihi"></td>
                    </tr> #}
                    <tr>
                        <td><label for="ek_bilgiler">Ek Bilgiler:</label></td>
                        <td><input type="text" class="form-control" id="ek_bilgiler" name="ek_bilgiler"></td>
                    </tr>
                    <tr>
                        <td colspan=2 style="text-align:center;">
                        <input type="submit" value="ARA" id="filterFormButton">
                        </td>
                    </tr>
                </table>
            </form>
        </div>
        <br>
        <table class = "table">  
            <tbody id = "client"></tbody>  
        </table>  
    </div>   
   
{% endblock %} 